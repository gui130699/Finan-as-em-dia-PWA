<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Teste Local PWA</title>
</head>
<body>
    <h1>Teste de Declaração Supabase</h1>
    <div id="resultado"></div>

    <!-- Carregar Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Config -->
    <script>
        window.SUPABASE_CONFIG = {
            url: 'https://xgdlagtezxpnwafdzpci.supabase.co',
            key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhnZGxhZ3RlenhwbndhZmR6cGNpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMxMzk1NTksImV4cCI6MjA3ODcxNTU1OX0.EQCHnNEzuPIxNu-2bOoO6RL2gs4W6qQAk8Bx3LTb2uU'
        };
    </script>
    
    <!-- Teste -->
    <script>
        const SUPABASE_URL = window.SUPABASE_CONFIG?.url || '';
        const SUPABASE_KEY = window.SUPABASE_CONFIG?.key || '';

        console.log('Teste 1: Verificando window.supabaseClient antes');
        console.log('window.supabaseClient existe?', typeof window.supabaseClient !== 'undefined');

        // Criar cliente
        if (typeof window.supabaseClient === 'undefined') {
            console.log('Teste 2: Criando novo cliente');
            window.supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        }
        
        console.log('Teste 3: Atribuindo a const supabase');
        const supabase = window.supabaseClient;
        
        console.log('Teste 4: Cliente criado com sucesso?', !!supabase);
        
        // Tentar criar novamente (deve usar o existente)
        console.log('Teste 5: Tentando criar novamente...');
        if (typeof window.supabaseClient === 'undefined') {
            console.log('ERRO: window.supabaseClient foi perdido!');
        } else {
            console.log('OK: window.supabaseClient já existe, reutilizando');
            const supabase2 = window.supabaseClient;
            console.log('Teste 6: Ambos clientes são iguais?', supabase === supabase2);
        }
        
        document.getElementById('resultado').innerHTML = `
            <p>✅ Teste concluído sem erros!</p>
            <p>Cliente Supabase: ${!!supabase ? 'Criado' : 'ERRO'}</p>
            <p>URL: ${SUPABASE_URL}</p>
        `;
    </script>
</body>
</html>
